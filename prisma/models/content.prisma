enum FeedType {
  TEXT
  MEDIA
  BLOCK
}

model Feed {
  id String @id @default(cuid())

  type        FeedType @default(TEXT)
  content     Json     @default("{}")
  commentable Boolean  @default(true)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  site     Site      @relation(fields: [siteId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  siteId   String
  user     User      @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  userId   String
  comments Comment[]
  likes    Like[]

  @@index([siteId])
  @@index([userId])
}

model Comment {
  id String @id @default(cuid())

  content String

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  feed   Feed?   @relation(fields: [feedId], references: [id])
  feedId String?

  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  userId String

  @@index([feedId])
  @@index([userId])
}
